<?phpinclude_once("../_database/athdbconn.php");include_once("../_database/athtranslate.php");$strMode = request("var_stats");$objConn = abreDBConn(CFG_DB);if(empty($strMode)){	$strMode = "WINDOW";}?><script src="../_scripts/jquery-1.3.min.js"></script><script>	$(document).ready(function(){		$('[menu=acord]').not(':first').hide();   		$('[rel=tituloAcord]').click(function(){ 			if($(this).next().is(':hidden')){				if($(this).parent().attr('name') != 'filho'){					$('[menu=acord]:visible').hide();   					$(this).next().show();				}else{					$(this).parent().parent().children('li').children('[menu=acord]:visible').hide();					if($(this).next('div').children('ul').children('li').length > 0){						$(this).next().show();					}					if($(this).attr('link') != '' ){						var link = $(this).attr('link');						alert(link);					}				}			}		});   	});</script><script>	var strMode = "<?php echo($strMode); ?>";		function pageRedirect(prLocation){		if(strMode == "WINDOW"){			window.opener.parent.document.getElementById("<?php echo(CFG_SYSTEM_NAME . "_frmain"); ?>").src = prLocation; 		}		else if(strMode == "FRAME"){			parent.document.getElementById("<?php echo(CFG_SYSTEM_NAME . "_frmain"); ?>").src = prLocation;		}	}</script><style>.boxAcordion{	cursor:pointer;	border:1px solid gray;	color:#FFFFFF;	background-color:gray;	padding:8px;	margin-bottom:1px;	font-size:12px;}.subMenu{	list-style-type:none;}</style><?php					function subMenu($prCodMenuPai, $prStrNivel, $objConnLocal,$prTamanho){				try{			$strSQL1   = "SELECT cod_mapa, rotulo, link FROM sys_mapa WHERE cod_mapa_pai = " . $prCodMenuPai . " AND dtt_inativo IS NULL AND grp_user = '" . getsession(CFG_SYSTEM_NAME . "_grp_user") . "' ORDER by ordem";			$objResult1 = $objConnLocal->query($strSQL1);		}		catch(PDOException $e){			mensagem("err_sql_titulo","err_sql_desc",$e->getMessage(),"","erro",1);			die();		}		$intAuxCont = 1;		$intTamanho = $prTamanho - 40 ;		foreach($objResult1 as $objRS1){			try{				$objRS = $objConnLocal->query("SELECT count(*) as total FROM sys_mapa WHERE cod_mapa_pai = " . getValue($objRS1,"cod_mapa"))->fetch();			}			catch(PDOException $e){				mensagem("err_sql_titulo","err_sql_desc",$e->getMessage(),"","erro",1);				die();			}						echo ("<li class='subMenu' name='filho' style='clear:left'>					<div rel='tituloAcord'  class=\"boxAcordion\" link='".getValue($objRS1,"link")."' style='width:".$intTamanho."px;'>".getTText(getValue($objRS1,"rotulo"),C_UCWORDS)."</div>					<div menu='acord' style='float:left;clear:left'>						<ul>");				subMenu(getValue($objRS1,"cod_mapa"), $prStrNivel . "," . $intAuxCont, $objConnLocal,$intTamanho);				echo("</ul></div></li>");			$intAuxCont++;		}			}			try{		$strSQL = "SELECT cod_mapa, rotulo, link FROM sys_mapa WHERE cod_mapa_pai <= 0 and dtt_inativo IS NULL AND grp_user = '" . getsession(CFG_SYSTEM_NAME . "_grp_user") . "' ORDER BY ordem";		$objResult = $objConn->query($strSQL); 	}	catch(PDOException $e){		mensagem("err_sql_titulo","err_sql_desc",$e->getMessage(),"","erro",1);		die();	}?><body><?php		$intCont = 1;		$intTamanho = 190;		foreach($objResult as $objRS){?>		<div style='float:left;clear:left'>		<div rel='tituloAcord' link='' class="boxAcordion" style='width:<?php echo($intTamanho)?>px;'><?php echo(getTText(getValue($objRS,"rotulo"),C_UCWORDS))?></div>		<div menu='acord' style='float:left;clear:left'>			<ul><?php				subMenu(getValue($objRS,"cod_mapa"),$intCont,$objConn,$intTamanho);				$intCont++;				?>			</ul>		</div>	</div><?php		}		$objResult->closeCursor();?>		</body>